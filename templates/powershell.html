<h1>PowerShell</h1>
<p>PowerShell is the Windows scripting language and configuration management<br>
framework from Microsoft built on the .NET Framework. Windows 7 and up ship<br>
with PowerShell.<br>
Nearly all examples below can be a part of a shell script or executed directly<br>
in the shell.</p>
<p>A key difference with Bash is that it is mostly objects that you manipulate<br>
rather than plain text. After years of evolving, it resembles Python a bit.</p>
<p><a href="https://docs.microsoft.com/powershell/scripting/overview" rel="nofollow">Read more here.</a></p>
<p>Powershell as a Language:</p>
<div class="highlight highlight-source-powershell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> Single line comments start with a number symbol.</span>

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">  Multi-line comments</span>
<span class="pl-c">  like so</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 1. Primitive Datatypes and Operators</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> Numbers</span>
<span class="pl-c1">3</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 3</span>

<span class="pl-c"><span class="pl-c">#</span> Math</span>
<span class="pl-c1">1</span> <span class="pl-k">+</span> <span class="pl-c1">1</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; 2</span>
<span class="pl-c1">8</span> <span class="pl-k">-</span> <span class="pl-c1">1</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; 7</span>
<span class="pl-c1">10</span> <span class="pl-k">*</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 20</span>
<span class="pl-c1">35</span> <span class="pl-k">/</span> <span class="pl-c1">5</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 7.0</span>

<span class="pl-c"><span class="pl-c">#</span> Powershell uses banker's rounding,</span>
<span class="pl-c"><span class="pl-c">#</span> meaning [int]1.5 would round to 2 but so would [int]2.5</span>
<span class="pl-c"><span class="pl-c">#</span> Division always returns a float. </span>
<span class="pl-c"><span class="pl-c">#</span> You must cast result to [int] to round.</span>
[<span class="pl-k">int</span>]<span class="pl-c1">5</span> <span class="pl-k">/</span> [<span class="pl-k">int</span>]<span class="pl-c1">3</span>       <span class="pl-c"><span class="pl-c">#</span> =&gt; 1.66666666666667</span>
[<span class="pl-k">int</span>]<span class="pl-c1">-5</span> <span class="pl-k">/</span> [<span class="pl-k">int</span>]<span class="pl-c1">3</span>      <span class="pl-c"><span class="pl-c">#</span> =&gt; -1.66666666666667</span>
<span class="pl-c1">5.0</span> <span class="pl-k">/</span> <span class="pl-c1">3.0</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; 1.66666666666667</span>
<span class="pl-c1">-5.0</span> <span class="pl-k">/</span> <span class="pl-c1">3.0</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; -1.66666666666667</span>
[<span class="pl-k">int</span>]<span class="pl-smi">$result</span> <span class="pl-k">=</span> <span class="pl-c1">5</span> <span class="pl-k">/</span> <span class="pl-c1">3</span> 
<span class="pl-smi">$result</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 2</span>

<span class="pl-c"><span class="pl-c">#</span> Modulo operation</span>
<span class="pl-c1">7</span> <span class="pl-k">%</span> <span class="pl-c1">3</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>

<span class="pl-c"><span class="pl-c">#</span> Exponentiation requires longform or the built-in [Math] class.</span>
[<span class="pl-k">Math</span>]::Pow(<span class="pl-c1">2</span><span class="pl-k">,</span><span class="pl-c1">3</span>)  <span class="pl-c"><span class="pl-c">#</span> =&gt; 8</span>

<span class="pl-c"><span class="pl-c">#</span> Enforce order of operations with parentheses.</span>
<span class="pl-c1">1</span> <span class="pl-k">+</span> <span class="pl-c1">3</span> <span class="pl-k">*</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 7</span>
(<span class="pl-c1">1</span> <span class="pl-k">+</span> <span class="pl-c1">3</span>) <span class="pl-k">*</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 8</span>

<span class="pl-c"><span class="pl-c">#</span> Boolean values are primitives (Note: the $)</span>
<span class="pl-c1">$True</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">$False</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>

<span class="pl-c"><span class="pl-c">#</span> negate with !</span>
<span class="pl-k">!</span><span class="pl-c1">$True</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-k">!</span><span class="pl-c1">$False</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> Boolean Operators</span>
<span class="pl-c"><span class="pl-c">#</span> Note "-and" and "-or" usage</span>
<span class="pl-c1">$True</span> <span class="pl-k">-and</span> <span class="pl-c1">$False</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">$False</span> <span class="pl-k">-or</span> <span class="pl-c1">$True</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> True and False are actually 1 and 0 but only support limited arithmetic.</span>
<span class="pl-c"><span class="pl-c">#</span> However, casting the bool to int resolves this.</span>
<span class="pl-c1">$True</span> <span class="pl-k">+</span> <span class="pl-c1">$True</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 2</span>
<span class="pl-c1">$True</span> <span class="pl-k">*</span> <span class="pl-c1">8</span>    <span class="pl-c"><span class="pl-c">#</span> =&gt; '[System.Boolean] * [System.Int32]' is undefined</span>
[<span class="pl-k">int</span>]<span class="pl-c1">$True</span> <span class="pl-k">*</span> <span class="pl-c1">8</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 8</span>
<span class="pl-c1">$False</span> <span class="pl-k">-</span> <span class="pl-c1">5</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; -5</span>

<span class="pl-c"><span class="pl-c">#</span> Comparison operators look at the numerical value of True and False.</span>
<span class="pl-c1">0</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">1</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">2</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>   <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">-5</span> <span class="pl-k">-ne</span> <span class="pl-c1">$False</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> Using boolean logical operators on ints casts to booleans for evaluation.</span>
<span class="pl-c"><span class="pl-c">#</span> but their non-cast value is returned</span>
<span class="pl-c"><span class="pl-c">#</span> Don't mix up with bool(ints) and bitwise -band/-bor</span>
[<span class="pl-k">bool</span>](<span class="pl-c1">0</span>)     <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
[<span class="pl-k">bool</span>](<span class="pl-c1">4</span>)     <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
[<span class="pl-k">bool</span>](<span class="pl-c1">-6</span>)    <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">0</span> <span class="pl-k">-band</span> <span class="pl-c1">2</span>     <span class="pl-c"><span class="pl-c">#</span> =&gt; 0</span>
<span class="pl-c1">-5</span> <span class="pl-k">-bor</span> <span class="pl-c1">0</span>     <span class="pl-c"><span class="pl-c">#</span> =&gt; -5</span>

<span class="pl-c"><span class="pl-c">#</span> Equality is -eq (equals)</span>
<span class="pl-c1">1</span> <span class="pl-k">-eq</span> <span class="pl-c1">1</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">2</span> <span class="pl-k">-eq</span> <span class="pl-c1">1</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>

<span class="pl-c"><span class="pl-c">#</span> Inequality is -ne (notequals)</span>
<span class="pl-c1">1</span> <span class="pl-k">-ne</span> <span class="pl-c1">1</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">2</span> <span class="pl-k">-ne</span> <span class="pl-c1">1</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> More comparisons</span>
<span class="pl-c1">1</span> <span class="pl-k">-lt</span> <span class="pl-c1">10</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">1</span> <span class="pl-k">-gt</span> <span class="pl-c1">10</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">2</span> <span class="pl-k">-le</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">2</span> <span class="pl-k">-ge</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> Seeing whether a value is in a range</span>
<span class="pl-c1">1</span> <span class="pl-k">-lt</span> <span class="pl-c1">2</span> <span class="pl-k">-and</span> <span class="pl-c1">2</span> <span class="pl-k">-lt</span> <span class="pl-c1">3</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">2</span> <span class="pl-k">-lt</span> <span class="pl-c1">3</span> <span class="pl-k">-and</span> <span class="pl-c1">3</span> <span class="pl-k">-lt</span> <span class="pl-c1">2</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>

<span class="pl-c"><span class="pl-c">#</span> (-is vs. -eq) -is checks if two objects are the same type.</span>
<span class="pl-c"><span class="pl-c">#</span> -eq checks if the objects have the same values.</span>
<span class="pl-c"><span class="pl-c">#</span> Note: we called '[Math]' from .NET previously without the preceeding</span>
<span class="pl-c"><span class="pl-c">#</span> namespaces. We can do the same with [Collections.ArrayList] if preferred.</span>
[<span class="pl-k">System.Collections.ArrayList</span>]<span class="pl-smi">$a</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()  <span class="pl-c"><span class="pl-c">#</span> Point a at a new list</span>
<span class="pl-smi">$a</span> <span class="pl-k">=</span> (<span class="pl-c1">1</span><span class="pl-k">,</span><span class="pl-c1">2</span><span class="pl-k">,</span><span class="pl-c1">3</span><span class="pl-k">,</span><span class="pl-c1">4</span>)
<span class="pl-smi">$b</span> <span class="pl-k">=</span> <span class="pl-smi">$a</span>                                 <span class="pl-c"><span class="pl-c">#</span> =&gt; Point b at what a is pointing to</span>
<span class="pl-smi">$b</span> <span class="pl-k">-is</span> <span class="pl-smi">$a<span class="pl-smi">.GetType</span></span>()                     <span class="pl-c"><span class="pl-c">#</span> =&gt; True, a and b equal same type</span>
<span class="pl-smi">$b</span> <span class="pl-k">-eq</span> <span class="pl-smi">$a</span>                               <span class="pl-c"><span class="pl-c">#</span> =&gt; True, a and b values are equal</span>
[<span class="pl-k">System.Collections.Hashtable</span>]<span class="pl-smi">$b</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{}  <span class="pl-c"><span class="pl-c">#</span> =&gt; Point a at a new hash table</span>
<span class="pl-smi">$b</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{<span class="pl-s"><span class="pl-pds">'</span>one<span class="pl-pds">'</span></span> <span class="pl-k">=</span> <span class="pl-c1">1</span> 
       <span class="pl-s"><span class="pl-pds">'</span>two<span class="pl-pds">'</span></span> <span class="pl-k">=</span> <span class="pl-c1">2</span>}
<span class="pl-smi">$b</span> <span class="pl-k">-is</span> <span class="pl-smi">$a<span class="pl-smi">.GetType</span></span>()                     <span class="pl-c"><span class="pl-c">#</span> =&gt; False, a and b types not equal</span>

<span class="pl-c"><span class="pl-c">#</span> Strings are created with " or ' but " is required for string interpolation</span>
<span class="pl-s"><span class="pl-pds">"</span>This is a string.<span class="pl-pds">"</span></span>
<span class="pl-s"><span class="pl-pds">'</span>This is also a string.<span class="pl-pds">'</span></span>

<span class="pl-c"><span class="pl-c">#</span> Strings can be added too! But try not to do this.</span>
<span class="pl-s"><span class="pl-pds">"</span>Hello <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>world!<span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; "Hello world!"</span>

<span class="pl-c"><span class="pl-c">#</span> A string can be treated like a list of characters</span>
<span class="pl-s"><span class="pl-pds">"</span>Hello world!<span class="pl-pds">"</span></span>[<span class="pl-c1">0</span>]  <span class="pl-c"><span class="pl-c">#</span> =&gt; 'H'</span>

<span class="pl-c"><span class="pl-c">#</span> You can find the length of a string</span>
(<span class="pl-s"><span class="pl-pds">"</span>This is a string<span class="pl-pds">"</span></span>).Length  <span class="pl-c"><span class="pl-c">#</span> =&gt; 16</span>

<span class="pl-c"><span class="pl-c">#</span> You can also format using f-strings or formatted string literals.</span>
<span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Steve<span class="pl-pds">"</span></span>
<span class="pl-smi">$age</span> <span class="pl-k">=</span> <span class="pl-c1">22</span>
<span class="pl-s"><span class="pl-pds">"</span>He said his name is <span class="pl-smi">$name</span>.<span class="pl-pds">"</span></span> 
<span class="pl-c"><span class="pl-c">#</span> =&gt; "He said his name is Steve"</span>
<span class="pl-s"><span class="pl-pds">"</span>{0} said he is {1} years old.<span class="pl-pds">"</span></span> <span class="pl-k">-f</span> <span class="pl-smi">$name</span><span class="pl-k">,</span> <span class="pl-smi">$age</span> 
<span class="pl-c"><span class="pl-c">#</span> =&gt; "Steve said he is 22 years old"</span>
<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$name</span>'s name is <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-smi">$name<span class="pl-smi">.Length</span></span><span class="pl-pse">)</span> characters long.<span class="pl-pds">"</span></span> 
<span class="pl-c"><span class="pl-c">#</span> =&gt; "Steve's name is 5 characters long."</span>

<span class="pl-c"><span class="pl-c">#</span> Escape Characters in Powershell</span>
<span class="pl-c"><span class="pl-c">#</span> Many languages use the '\', but Windows uses this character for </span>
<span class="pl-c"><span class="pl-c">#</span> file paths. Powershell thus uses '`' to escape characters</span>
<span class="pl-c"><span class="pl-c">#</span> Take caution when working with files, as '`' is a</span>
<span class="pl-c"><span class="pl-c">#</span> valid character in NTFS filenames.</span>
<span class="pl-s"><span class="pl-pds">"</span>Showing<span class="pl-cce">`n</span>Escape Chars<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">#</span> =&gt; new line between Showing and Escape</span>
<span class="pl-s"><span class="pl-pds">"</span>Making<span class="pl-cce">`t</span>Tables<span class="pl-cce">`t</span>With<span class="pl-cce">`t</span>Tabs<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">#</span> =&gt; Format things with tabs</span>

<span class="pl-c"><span class="pl-c">#</span> Negate pound sign to prevent comment</span>
<span class="pl-c"><span class="pl-c">#</span> Note that the function of '#' is removed, but '#' is still present</span>
<span class="pl-k">`</span>#<span class="pl-c1">Get-Process</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; Fail: not a recognized cmdlet</span>

<span class="pl-c"><span class="pl-c">#</span> $null is not an object</span>
<span class="pl-c1">$null</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; None</span>

<span class="pl-c"><span class="pl-c">#</span> $null, 0, and empty strings and arrays all evaluate to False.</span>
<span class="pl-c"><span class="pl-c">#</span> All other values are True</span>
<span class="pl-k">function</span> <span class="pl-en">Test-Value</span> (<span class="pl-smi">$value</span>) {
  <span class="pl-k">if</span> (<span class="pl-smi">$value</span>) {
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">'</span>True<span class="pl-pds">'</span></span>
  }
  <span class="pl-k">else</span> {
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">'</span>False<span class="pl-pds">'</span></span>
  }
}

<span class="pl-c1">Test-Value</span> (<span class="pl-c1">$null</span>) <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">Test-Value</span> (<span class="pl-c1">0</span>)     <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">Test-Value</span> (<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)    <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>
<span class="pl-c1">Test-Value</span> []      <span class="pl-c"><span class="pl-c">#</span> =&gt; True </span>
<span class="pl-c"><span class="pl-c">#</span> *[] calls .NET class; creates '[]' string when passed to function</span>
<span class="pl-c1">Test-Value</span> ({})    <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">Test-Value</span> <span class="pl-k">@</span>()     <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 2. Variables and Collections</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> Powershell uses the "Write-Output" function to print</span>
<span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span>I'm Posh. Nice to meet you!<span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; I'm Posh. Nice to meet you!</span>

<span class="pl-c"><span class="pl-c">#</span> Simple way to get input data from console</span>
<span class="pl-smi">$userInput</span> <span class="pl-k">=</span> <span class="pl-c1">Read-Host</span> <span class="pl-s"><span class="pl-pds">"</span>Enter some data: <span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">#</span> Returns the data as a string</span>

<span class="pl-c"><span class="pl-c">#</span> There are no declarations, only assignments.</span>
<span class="pl-c"><span class="pl-c">#</span> Convention is to use camelCase or PascalCase, whatever your team uses.</span>
<span class="pl-smi">$someVariable</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>
<span class="pl-smi">$someVariable</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 5</span>

<span class="pl-c"><span class="pl-c">#</span> Accessing a previously unassigned variable does not throw exception.</span>
<span class="pl-c"><span class="pl-c">#</span> The value is $null by default</span>

<span class="pl-c"><span class="pl-c">#</span> Ternary Operators exist in Powershell 7 and up</span>
<span class="pl-c1">0</span> <span class="pl-k">?</span> <span class="pl-s"><span class="pl-pds">'</span>yes<span class="pl-pds">'</span></span> : <span class="pl-s"><span class="pl-pds">'</span>no<span class="pl-pds">'</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; no</span>


<span class="pl-c"><span class="pl-c">#</span> The default array object in Powershell is an fixed length array.</span>
<span class="pl-smi">$defaultArray</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>thing<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>thing2<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>thing3<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">#</span> you can add objects with '+=', but cannot remove objects.</span>
<span class="pl-smi">$defaultArray<span class="pl-smi">.Add</span></span>(<span class="pl-s"><span class="pl-pds">"</span>thing4<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">#</span> =&gt; Exception "Collection was of a fixed size."</span>
<span class="pl-c"><span class="pl-c">#</span> To have a more workable array, you'll want the .NET [ArrayList] class</span>
<span class="pl-c"><span class="pl-c">#</span> It is also worth noting that ArrayLists are significantly faster</span>

<span class="pl-c"><span class="pl-c">#</span> ArrayLists store sequences</span>
[<span class="pl-k">System.Collections.ArrayList</span>]<span class="pl-smi">$array</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()
<span class="pl-c"><span class="pl-c">#</span> You can start with a prefilled ArrayList</span>
[<span class="pl-k">System.Collections.ArrayList</span>]<span class="pl-smi">$otherArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-c1">5</span><span class="pl-k">,</span> <span class="pl-c1">6</span>)

<span class="pl-c"><span class="pl-c">#</span> Add to the end of a list with 'Add' (Note: produces output, append to $null)</span>
<span class="pl-smi">$array<span class="pl-smi">.Add</span></span>(<span class="pl-c1">1</span>) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>    <span class="pl-c"><span class="pl-c">#</span> $array is now [1]</span>
<span class="pl-smi">$array<span class="pl-smi">.Add</span></span>(<span class="pl-c1">2</span>) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>    <span class="pl-c"><span class="pl-c">#</span> $array is now [1, 2]</span>
<span class="pl-smi">$array<span class="pl-smi">.Add</span></span>(<span class="pl-c1">4</span>) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>    <span class="pl-c"><span class="pl-c">#</span> $array is now [1, 2, 4]</span>
<span class="pl-smi">$array<span class="pl-smi">.Add</span></span>(<span class="pl-c1">3</span>) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>    <span class="pl-c"><span class="pl-c">#</span> $array is now [1, 2, 4, 3]</span>
<span class="pl-c"><span class="pl-c">#</span> Remove from end with index of count of objects-1; array index starts at 0</span>
<span class="pl-smi">$array<span class="pl-smi">.RemoveAt</span></span>(<span class="pl-smi">$array<span class="pl-smi">.Count</span></span><span class="pl-k">-</span><span class="pl-c1">1</span>) <span class="pl-c"><span class="pl-c">#</span> =&gt; 3 and array is now [1, 2, 4]</span>
<span class="pl-c"><span class="pl-c">#</span> Let's put it back</span>
<span class="pl-smi">$array<span class="pl-smi">.Add</span></span>(<span class="pl-c1">3</span>) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>   <span class="pl-c"><span class="pl-c">#</span> array is now [1, 2, 4, 3] again.</span>

<span class="pl-c"><span class="pl-c">#</span> Access a list like you would any array</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">0</span>]   <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>
<span class="pl-c"><span class="pl-c">#</span> Look at the last element</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">-1</span>]  <span class="pl-c"><span class="pl-c">#</span> =&gt; 3</span>

<span class="pl-c"><span class="pl-c">#</span> Looking out of bounds returns nothing</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">4</span>]  <span class="pl-c"><span class="pl-c">#</span> blank line returned</span>

<span class="pl-c"><span class="pl-c">#</span> You can look at ranges with slice syntax.</span>
<span class="pl-c"><span class="pl-c">#</span> The start index is included, the end index is not</span>
<span class="pl-c"><span class="pl-c">#</span> (It's a closed/open range for you mathy types.)</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">1</span><span class="pl-k">..</span><span class="pl-c1">3</span>]   <span class="pl-c"><span class="pl-c">#</span> Return array from index 1 to 3 =&gt; [2, 4]</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">2</span><span class="pl-k">..</span><span class="pl-c1">-1</span>]    <span class="pl-c"><span class="pl-c">#</span> Return array starting from index 2 =&gt; [4, 3]</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">0</span><span class="pl-k">..</span><span class="pl-c1">3</span>]    <span class="pl-c"><span class="pl-c">#</span> Return array from beginning until index 3  =&gt; [1, 2, 4]</span>
<span class="pl-smi">$array</span>[<span class="pl-c1">0</span><span class="pl-k">..</span><span class="pl-c1">2</span>]   <span class="pl-c"><span class="pl-c">#</span> Return array selecting every second entry =&gt; [1, 4]</span>
<span class="pl-smi">$array<span class="pl-smi">.Reverse</span></span>()  <span class="pl-c"><span class="pl-c">#</span> mutates array to reverse order =&gt; [3, 4, 2, 1]</span>
<span class="pl-c"><span class="pl-c">#</span> Use any combination of these to make advanced slices</span>

<span class="pl-c"><span class="pl-c">#</span> Remove arbitrary elements from a array with "del"</span>
<span class="pl-smi">$array<span class="pl-smi">.Remove</span></span>(<span class="pl-smi">$array</span>[<span class="pl-c1">2</span>])  <span class="pl-c"><span class="pl-c">#</span> $array is now [1, 2, 3]</span>

<span class="pl-c"><span class="pl-c">#</span> Insert an element at a specific index</span>
<span class="pl-smi">$array<span class="pl-smi">.Insert</span></span>(<span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-c1">2</span>)  <span class="pl-c"><span class="pl-c">#</span> $array is now [1, 2, 3] again</span>

<span class="pl-c"><span class="pl-c">#</span> Get the index of the first item found matching the argument</span>
<span class="pl-smi">$array<span class="pl-smi">.IndexOf</span></span>(<span class="pl-c1">2</span>)  <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>
<span class="pl-smi">$array<span class="pl-smi">.IndexOf</span></span>(<span class="pl-c1">6</span>)  <span class="pl-c"><span class="pl-c">#</span> Returns -1 as "outside array" </span>

<span class="pl-c"><span class="pl-c">#</span> You can add arrays</span>
<span class="pl-c"><span class="pl-c">#</span> Note: values for $array and for $otherArray are not modified.</span>
<span class="pl-smi">$array</span> <span class="pl-k">+</span> <span class="pl-smi">$otherArray</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; [1, 2, 3, 4, 5, 6]</span>

<span class="pl-c"><span class="pl-c">#</span> Concatenate arrays with "AddRange()"</span>
<span class="pl-smi">$array<span class="pl-smi">.AddRange</span></span>(<span class="pl-smi">$otherArray</span>)  <span class="pl-c"><span class="pl-c">#</span> Now $array is [1, 2, 3, 4, 5, 6]</span>

<span class="pl-c"><span class="pl-c">#</span> Check for existence in a array with "in"</span>
<span class="pl-c1">1</span> <span class="pl-k">-in</span> <span class="pl-smi">$array</span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>

<span class="pl-c"><span class="pl-c">#</span> Examine length with "Count" (Note: "Length" on arrayList = each items length)</span>
<span class="pl-smi">$array<span class="pl-smi">.Count</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; 6</span>


<span class="pl-c"><span class="pl-c">#</span> Tuples are like arrays but are immutable.</span>
<span class="pl-c"><span class="pl-c">#</span> To use Tuples in powershell, you must use the .NET tuple class.</span>
<span class="pl-smi">$tuple</span> <span class="pl-k">=</span> [<span class="pl-k">System.Tuple</span>]::Create(<span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-c1">3</span>)
<span class="pl-smi">$tuple<span class="pl-smi">.Item</span></span>(<span class="pl-c1">0</span>)      <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>
<span class="pl-smi">$tuple<span class="pl-smi">.Item</span></span>(<span class="pl-c1">0</span>) <span class="pl-k">=</span> <span class="pl-c1">3</span>  <span class="pl-c"><span class="pl-c">#</span> Raises a TypeError</span>

<span class="pl-c"><span class="pl-c">#</span> You can do some of the array methods on tuples, but they are limited.</span>
<span class="pl-smi">$tuple<span class="pl-smi">.Length</span></span>       <span class="pl-c"><span class="pl-c">#</span> =&gt; 3</span>
<span class="pl-smi">$tuple</span> <span class="pl-k">+</span> (<span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-c1">5</span><span class="pl-k">,</span> <span class="pl-c1">6</span>)  <span class="pl-c"><span class="pl-c">#</span> =&gt; Exception</span>
<span class="pl-smi">$tuple</span>[<span class="pl-c1">0</span><span class="pl-k">..</span><span class="pl-c1">2</span>]        <span class="pl-c"><span class="pl-c">#</span> =&gt; $null</span>
<span class="pl-c1">2</span> <span class="pl-k">-in</span> <span class="pl-smi">$tuple</span>        <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>


<span class="pl-c"><span class="pl-c">#</span> Hashtables store mappings from keys to values, similar to Dictionaries.</span>
<span class="pl-smi">$emptyHash</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{}
<span class="pl-c"><span class="pl-c">#</span> Here is a prefilled dictionary</span>
<span class="pl-smi">$filledHash</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span><span class="pl-k">=</span> <span class="pl-c1">1</span> 
                <span class="pl-s"><span class="pl-pds">"</span>two<span class="pl-pds">"</span></span><span class="pl-k">=</span> <span class="pl-c1">2</span> 
                <span class="pl-s"><span class="pl-pds">"</span>three<span class="pl-pds">"</span></span><span class="pl-k">=</span> <span class="pl-c1">3</span>}

<span class="pl-c"><span class="pl-c">#</span> Look up values with []</span>
<span class="pl-smi">$filledHash</span>[<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span>]  <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>

<span class="pl-c"><span class="pl-c">#</span> Get all keys as an iterable with ".Keys".</span>
<span class="pl-c"><span class="pl-c">#</span> items maintain the order at which they are inserted into the dictionary.</span>
<span class="pl-smi">$filledHash<span class="pl-smi">.Keys</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; ["one", "two", "three"]</span>

<span class="pl-c"><span class="pl-c">#</span> Get all values as an iterable with ".Values".</span>
<span class="pl-smi">$filledHash<span class="pl-smi">.Values</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; [1, 2, 3]</span>

<span class="pl-c"><span class="pl-c">#</span> Check for existence of keys or values in a hash with "-in"</span>
<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span> <span class="pl-k">-in</span> <span class="pl-smi">$filledHash<span class="pl-smi">.Keys</span></span>  <span class="pl-c"><span class="pl-c">#</span> =&gt; True</span>
<span class="pl-c1">1</span> <span class="pl-k">-in</span> <span class="pl-smi">$filledHash<span class="pl-smi">.Values</span></span>    <span class="pl-c"><span class="pl-c">#</span> =&gt; False</span>

<span class="pl-c"><span class="pl-c">#</span> Looking up a non-existing key returns $null</span>
<span class="pl-smi">$filledHash</span>[<span class="pl-s"><span class="pl-pds">"</span>four<span class="pl-pds">"</span></span>]  <span class="pl-c"><span class="pl-c">#</span> $null</span>

<span class="pl-c"><span class="pl-c">#</span> Adding to a dictionary</span>
<span class="pl-smi">$filledHash<span class="pl-smi">.Add</span></span>(<span class="pl-s"><span class="pl-pds">"</span>five<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-c1">5</span>)  <span class="pl-c"><span class="pl-c">#</span> $filledHash["five"] is set to 5</span>
<span class="pl-smi">$filledHash<span class="pl-smi">.Add</span></span>(<span class="pl-s"><span class="pl-pds">"</span>five<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-c1">6</span>)  <span class="pl-c"><span class="pl-c">#</span> exception "Item with key "five" has already been added"</span>
<span class="pl-smi">$filledHash</span>[<span class="pl-s"><span class="pl-pds">"</span>four<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-c1">4</span> <span class="pl-c"><span class="pl-c">#</span> $filledHash["four"] is set to 4, running again does nothing</span>

<span class="pl-c"><span class="pl-c">#</span> Remove keys from a dictionary with del</span>
<span class="pl-smi">$filledHash<span class="pl-smi">.Remove</span></span>(<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">#</span> Removes the key "one" from filled dict</span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 3. Control Flow and Iterables</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> Let's just make a variable</span>
<span class="pl-smi">$someVar</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>

<span class="pl-c"><span class="pl-c">#</span> Here is an if statement.</span>
<span class="pl-c"><span class="pl-c">#</span> This prints "$someVar is smaller than 10"</span>
<span class="pl-k">if</span> (<span class="pl-smi">$someVar</span> <span class="pl-k">-gt</span> <span class="pl-c1">10</span>) {
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$someVar</span> is bigger than 10.<span class="pl-pds">"</span></span>
}
<span class="pl-k">elseif</span> (<span class="pl-smi">$someVar</span> <span class="pl-k">-lt</span> <span class="pl-c1">10</span>) {    <span class="pl-c"><span class="pl-c">#</span> This elseif clause is optional.</span>
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$someVar</span> is smaller than 10.<span class="pl-pds">"</span></span>
}
<span class="pl-k">else</span> {                        <span class="pl-c"><span class="pl-c">#</span> This is optional too.</span>
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$someVar</span> is indeed 10.<span class="pl-pds">"</span></span>
}


<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">Foreach loops iterate over arrays</span>
<span class="pl-c">prints:</span>
<span class="pl-c">    dog is a mammal</span>
<span class="pl-c">    cat is a mammal</span>
<span class="pl-c">    mouse is a mammal</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
<span class="pl-k">foreach</span> (<span class="pl-smi">$animal</span> <span class="pl-k">in</span> (<span class="pl-s"><span class="pl-pds">"</span>dog<span class="pl-pds">"</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">"</span>cat<span class="pl-pds">"</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">"</span>mouse<span class="pl-pds">"</span></span>)) {
    <span class="pl-c"><span class="pl-c">#</span> You can use -f to interpolate formatted strings</span>
    <span class="pl-s"><span class="pl-pds">"</span>{0} is a mammal<span class="pl-pds">"</span></span> <span class="pl-k">-f</span> <span class="pl-smi">$animal</span>
}

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">For loops iterate over arrays and you can specify indices</span>
<span class="pl-c">prints:</span>
<span class="pl-c">   0 a</span>
<span class="pl-c">   1 b</span>
<span class="pl-c">   2 c</span>
<span class="pl-c">   3 d</span>
<span class="pl-c">   4 e</span>
<span class="pl-c">   5 f</span>
<span class="pl-c">   6 g</span>
<span class="pl-c">   7 h</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
<span class="pl-smi">$letters</span> <span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>d<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>e<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>f<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>h<span class="pl-pds">'</span></span>)
<span class="pl-k">for</span>(<span class="pl-smi">$i</span><span class="pl-k">=</span><span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-le</span> <span class="pl-smi">$letters<span class="pl-smi">.Count</span></span><span class="pl-k">-</span><span class="pl-c1">1</span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>){
    <span class="pl-c1">Write-Host</span> <span class="pl-smi">$i</span><span class="pl-k">,</span> <span class="pl-smi">$letters</span>[<span class="pl-smi">$i</span>]
}

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">While loops go until a condition is no longer met.</span>
<span class="pl-c">prints:</span>
<span class="pl-c">    0</span>
<span class="pl-c">    1</span>
<span class="pl-c">    2</span>
<span class="pl-c">    3</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
<span class="pl-smi">$x</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>
<span class="pl-k">while</span> (<span class="pl-smi">$x</span> <span class="pl-k">-lt</span> <span class="pl-c1">4</span>) {
    <span class="pl-c1">Write-Output</span> <span class="pl-smi">$x</span>
    <span class="pl-smi">$x</span> <span class="pl-k">+=</span> <span class="pl-c1">1</span>  <span class="pl-c"><span class="pl-c">#</span> Shorthand for x = x + 1</span>
}

<span class="pl-c"><span class="pl-c">#</span> Switch statements are more powerful compared to most languages</span>
<span class="pl-smi">$val</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>20<span class="pl-pds">"</span></span>
<span class="pl-k">switch</span>(<span class="pl-smi">$val</span>) {
  { <span class="pl-c1">$_</span> <span class="pl-k">-eq</span> <span class="pl-c1">42</span> }           { <span class="pl-s"><span class="pl-pds">"</span>The answer equals 42<span class="pl-pds">"</span></span>; <span class="pl-k">break</span> }
  <span class="pl-s"><span class="pl-pds">'</span>20<span class="pl-pds">'</span></span>                    { <span class="pl-s"><span class="pl-pds">"</span>Exactly 20<span class="pl-pds">"</span></span>; <span class="pl-k">break</span> }
  { <span class="pl-c1">$_</span> <span class="pl-k">-like</span> <span class="pl-s"><span class="pl-pds">'</span>s*<span class="pl-pds">'</span></span> }       { <span class="pl-s"><span class="pl-pds">"</span>Case insensitive<span class="pl-pds">"</span></span>; <span class="pl-k">break</span> }
  { <span class="pl-c1">$_</span> <span class="pl-k">-clike</span> <span class="pl-s"><span class="pl-pds">'</span>s*<span class="pl-pds">'</span></span>}       { <span class="pl-s"><span class="pl-pds">"</span>clike, ceq, cne for case sensitive<span class="pl-pds">"</span></span>; <span class="pl-k">break</span> }
  { <span class="pl-c1">$_</span> <span class="pl-k">-notmatch</span> <span class="pl-s"><span class="pl-pds">'</span>^.*$<span class="pl-pds">'</span></span>}  { <span class="pl-s"><span class="pl-pds">"</span>Regex matching. cnotmatch, cnotlike, ...<span class="pl-pds">"</span></span>; <span class="pl-k">break</span> }
  <span class="pl-k">default</span>                 { <span class="pl-s"><span class="pl-pds">"</span>Others<span class="pl-pds">"</span></span> }
}

<span class="pl-c"><span class="pl-c">#</span> Handle exceptions with a try/catch block</span>
<span class="pl-k">try</span> {
    <span class="pl-c"><span class="pl-c">#</span> Use "throw" to raise an error</span>
    <span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">"</span>This is an error<span class="pl-pds">"</span></span>
}
<span class="pl-k">catch</span> {
    <span class="pl-c1">Write-Output</span> <span class="pl-c1">$Error<span class="pl-smi">.ExceptionMessage</span></span>
}
<span class="pl-k">finally</span> {
    <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span>We can clean up resources here<span class="pl-pds">"</span></span>
}


<span class="pl-c"><span class="pl-c">#</span> Writing to a file</span>
<span class="pl-smi">$contents</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{<span class="pl-s"><span class="pl-pds">"</span>aa<span class="pl-pds">"</span></span><span class="pl-k">=</span> <span class="pl-c1">12</span> 
             <span class="pl-s"><span class="pl-pds">"</span>bb<span class="pl-pds">"</span></span><span class="pl-k">=</span> <span class="pl-c1">21</span>}
<span class="pl-smi">$contents</span> <span class="pl-k">|</span> <span class="pl-c1">Export-CSV</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$<span class="pl-c1">env:</span>HOMEDRIVE</span>\file.csv<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">#</span> writes to a file</span>

<span class="pl-smi">$contents</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>test string here<span class="pl-pds">"</span></span>
<span class="pl-smi">$contents</span> <span class="pl-k">|</span> <span class="pl-c1">Out-File</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$<span class="pl-c1">env:</span>HOMEDRIVE</span>\file.txt<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">#</span> writes to another file</span>

<span class="pl-c"><span class="pl-c">#</span> Read file contents and convert to json</span>
<span class="pl-c1">Get-Content</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$<span class="pl-c1">env:</span>HOMEDRIVE</span>\file.csv<span class="pl-pds">"</span></span> <span class="pl-k">|</span> <span class="pl-c1">ConvertTo-Json</span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 4. Functions</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> Use "function" to create new functions</span>
<span class="pl-c"><span class="pl-c">#</span> Keep the Verb-Noun naming convention for functions</span>
<span class="pl-k">function</span> <span class="pl-en">Add-Numbers</span> {
 <span class="pl-c1">$args</span>[<span class="pl-c1">0</span>] <span class="pl-k">+</span> <span class="pl-c1">$args</span>[<span class="pl-c1">1</span>]
}

<span class="pl-c1">Add-Numbers</span> <span class="pl-c1">1</span> <span class="pl-c1">2</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 3</span>

<span class="pl-c"><span class="pl-c">#</span> Calling functions with parameters</span>
<span class="pl-k">function</span> <span class="pl-en">Add-ParamNumbers</span> {
 <span class="pl-k">param</span>( [<span class="pl-k">int</span>]<span class="pl-smi">$firstNumber</span><span class="pl-k">,</span> [<span class="pl-k">int</span>]<span class="pl-smi">$secondNumber</span> )
 <span class="pl-smi">$firstNumber</span> <span class="pl-k">+</span> <span class="pl-smi">$secondNumber</span>
}

<span class="pl-c1">Add-ParamNumbers</span> <span class="pl-k">-</span>FirstNumber <span class="pl-c1">1</span> <span class="pl-k">-</span>SecondNumber <span class="pl-c1">2</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 3 </span>

<span class="pl-c"><span class="pl-c">#</span> Functions with named parameters, parameter attributes, parsable documentation</span>
<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">SYNOPSIS</span></span></span>
<span class="pl-c">Setup a new website</span>
<span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">DESCRIPTION</span></span></span>
<span class="pl-c">Creates everything your new website needs for much win</span>
<span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">siteName</span></span></span>
<span class="pl-c">The name for the new website</span>
<span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span>
<span class="pl-c">New-Website -Name FancySite -Po 5000</span>
<span class="pl-c">New-Website SiteWithDefaultPort</span>
<span class="pl-c">New-Website siteName 2000 # ERROR! Port argument could not be validated</span>
<span class="pl-c">('name1','name2') | New-Website -Verbose</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
<span class="pl-k">function</span> <span class="pl-en">New-Website</span>() {
    [<span class="pl-c1">CmdletBinding</span>()]
    <span class="pl-k">param</span> (
        [<span class="pl-c1">Parameter</span>(<span class="pl-v">ValueFromPipeline</span><span class="pl-k">=</span><span class="pl-c1">$true</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]
        [<span class="pl-c1">Alias</span>(<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>)]
        [<span class="pl-k">string</span>]<span class="pl-smi">$siteName</span><span class="pl-k">,</span>
        [<span class="pl-c1">ValidateSet</span>(<span class="pl-c1">3000</span><span class="pl-k">,</span><span class="pl-c1">5000</span><span class="pl-k">,</span><span class="pl-c1">8000</span>)]
        [<span class="pl-k">int</span>]<span class="pl-smi">$port</span> <span class="pl-k">=</span> <span class="pl-c1">3000</span>
    )
    <span class="pl-k">BEGIN</span> { <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">'</span>Creating new website(s)<span class="pl-pds">'</span></span> }
    <span class="pl-k">PROCESS</span> { <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">"</span>name: <span class="pl-smi">$siteName</span>, port: <span class="pl-smi">$port</span><span class="pl-pds">"</span></span> }
    <span class="pl-k">END</span> { <span class="pl-c1">Write-Output</span> <span class="pl-s"><span class="pl-pds">'</span>Website(s) created<span class="pl-pds">'</span></span> }
}


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 5. Modules</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> You can import modules and install modules</span>
<span class="pl-c"><span class="pl-c">#</span> The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span>
<span class="pl-c1">Install-Module</span> dbaTools
<span class="pl-c1">Import-Module</span> dbaTools

<span class="pl-smi">$query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>SELECT * FROM dbo.sometable<span class="pl-pds">"</span></span>
<span class="pl-smi">$queryParams</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{
    <span class="pl-smi">SqlInstance</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>testInstance<span class="pl-pds">'</span></span>
    <span class="pl-smi">Database</span>    <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>testDatabase<span class="pl-pds">'</span></span>
    <span class="pl-smi">Query</span>       <span class="pl-k">=</span> <span class="pl-smi">$query</span>
}
<span class="pl-c1">Invoke-DbaQuery</span> <span class="pl-smi">@queryParams</span>

<span class="pl-c"><span class="pl-c">#</span> You can get specific functions from a module</span>
<span class="pl-c1">Import-Module</span> <span class="pl-k">-</span>Function <span class="pl-c1">Invoke-DbaQuery</span>


<span class="pl-c"><span class="pl-c">#</span> Powershell modules are just ordinary Posh files. You</span>
<span class="pl-c"><span class="pl-c">#</span> can write your own, and import them. The name of the</span>
<span class="pl-c"><span class="pl-c">#</span> module is the same as the name of the file.</span>

<span class="pl-c"><span class="pl-c">#</span> You can find out which functions and attributes</span>
<span class="pl-c"><span class="pl-c">#</span> are defined in a module.</span>
<span class="pl-c1">Get-Command</span> <span class="pl-k">-</span>module dbaTools
<span class="pl-c1">Get-Help</span> dbaTools <span class="pl-k">-</span>Full


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 6. Classes</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> We use the "class" statement to create a class</span>
<span class="pl-k">class</span> <span class="pl-en">Instrument</span> {
    [<span class="pl-k">string</span>]<span class="pl-smi">$Type</span>
    [<span class="pl-k">string</span>]<span class="pl-smi">$Family</span>
}

<span class="pl-smi">$instrument</span> <span class="pl-k">=</span> [<span class="pl-k">Instrument</span>]::new()
<span class="pl-smi">$instrument<span class="pl-smi">.Type</span></span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>String Instrument<span class="pl-pds">"</span></span>
<span class="pl-smi">$instrument<span class="pl-smi">.Family</span></span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Plucked String<span class="pl-pds">"</span></span>

<span class="pl-smi">$instrument</span>

<span class="pl-c"><span class="pl-c">&lt;#</span> Output:</span>
<span class="pl-c">Type              Family        </span>
<span class="pl-c">----              ------        </span>
<span class="pl-c">String Instrument Plucked String</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 6.1 Inheritance</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> Inheritance allows new child classes to be defined that inherit </span>
<span class="pl-c"><span class="pl-c">#</span> methods and variables from their parent class.</span>

<span class="pl-k">class</span> <span class="pl-en">Guitar</span> : Instrument
{
    [<span class="pl-k">string</span>]<span class="pl-smi">$Brand</span>
    [<span class="pl-k">string</span>]<span class="pl-smi">$SubType</span>
    [<span class="pl-k">string</span>]<span class="pl-smi">$ModelType</span>
    [<span class="pl-k">string</span>]<span class="pl-smi">$ModelNumber</span>
}

<span class="pl-smi">$myGuitar</span> <span class="pl-k">=</span> [<span class="pl-k">Guitar</span>]::new()
<span class="pl-smi">$myGuitar<span class="pl-smi">.Brand</span></span>       <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Taylor<span class="pl-pds">"</span></span>
<span class="pl-smi">$myGuitar<span class="pl-smi">.SubType</span></span>     <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Acoustic<span class="pl-pds">"</span></span>
<span class="pl-smi">$myGuitar<span class="pl-smi">.ModelType</span></span>   <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Presentation<span class="pl-pds">"</span></span>
<span class="pl-smi">$myGuitar<span class="pl-smi">.ModelNumber</span></span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>PS14ce Blackwood<span class="pl-pds">"</span></span>

<span class="pl-smi">$myGuitar<span class="pl-smi">.GetType</span></span>()

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">IsPublic IsSerial Name                                     BaseType                                               </span>
<span class="pl-c">-------- -------- ----                                     --------                                               </span>
<span class="pl-c">True     False    Guitar                                   Instrument  </span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>


<span class="pl-c"><span class="pl-c">#</span>###################################################</span>
<span class="pl-c"><span class="pl-c">#</span># 7. Advanced</span>
<span class="pl-c"><span class="pl-c">#</span>###################################################</span>

<span class="pl-c"><span class="pl-c">#</span> The powershell pipeline allows things like High-Order Functions.</span>

<span class="pl-c"><span class="pl-c">#</span> Group-Object is a handy cmdlet that does incredible things.</span>
<span class="pl-c"><span class="pl-c">#</span> It works much like a GROUP BY in SQL.</span>

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"> The following will get all the running processes,</span>
<span class="pl-c"> group them by Name,</span>
<span class="pl-c"> and tell us how many instances of each process we have running.</span>
<span class="pl-c"> Tip: Chrome and svcHost are usually big numbers in this regard.</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
<span class="pl-c1">Get-Process</span> <span class="pl-k">|</span> <span class="pl-c1">Foreach-Object</span> ProcessName <span class="pl-k">|</span> <span class="pl-c1">Group-Object</span>

<span class="pl-c"><span class="pl-c">#</span> Useful pipeline examples are iteration and filtering.</span>
<span class="pl-c1">1</span><span class="pl-k">..</span><span class="pl-c1">10</span> <span class="pl-k">|</span> <span class="pl-c1">ForEach-Object</span> { <span class="pl-s"><span class="pl-pds">"</span>Loop number <span class="pl-c1">$PSITEM</span><span class="pl-pds">"</span></span> }
<span class="pl-c1">1</span><span class="pl-k">..</span><span class="pl-c1">10</span> <span class="pl-k">|</span> <span class="pl-c1">Where-Object</span> { <span class="pl-c1">$PSITEM</span> <span class="pl-k">-gt</span> <span class="pl-c1">5</span> } <span class="pl-k">|</span> <span class="pl-c1">ConvertTo-Json</span>

<span class="pl-c"><span class="pl-c">#</span> A notable pitfall of the pipeline is it's performance when</span>
<span class="pl-c"><span class="pl-c">#</span> compared with other options.</span>
<span class="pl-c"><span class="pl-c">#</span> Additionally, raw bytes are not passed through the pipeline,</span>
<span class="pl-c"><span class="pl-c">#</span> so passing an image causes some issues.</span>
<span class="pl-c"><span class="pl-c">#</span> See more on that in the link at the bottom.</span>

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"> Asynchronous functions exist in the form of jobs.</span>
<span class="pl-c"> Typically a procedural language,</span>
<span class="pl-c"> Powershell can operate non-blocking functions when invoked as Jobs.</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>

<span class="pl-c"><span class="pl-c">#</span> This function is known to be non-optimized, and therefore slow.</span>
<span class="pl-smi">$installedApps</span> <span class="pl-k">=</span> <span class="pl-c1">Get-CimInstance</span> <span class="pl-k">-</span>ClassName Win32_Product

<span class="pl-c"><span class="pl-c">#</span> If we had a script, it would hang at this func for a period of time.</span>
<span class="pl-smi">$scriptBlock</span> <span class="pl-k">=</span> {<span class="pl-c1">Get-CimInstance</span> <span class="pl-k">-</span>ClassName Win32_Product}
<span class="pl-c1">Start-Job</span> <span class="pl-k">-</span>ScriptBlock <span class="pl-smi">$scriptBlock</span>

<span class="pl-c"><span class="pl-c">#</span> This will start a background job that runs the command.</span>
<span class="pl-c"><span class="pl-c">#</span> You can then obtain the status of jobs and their returned results.</span>
<span class="pl-smi">$allJobs</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Job</span>
<span class="pl-smi">$jobResponse</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Job</span> <span class="pl-k">|</span> <span class="pl-c1">Receive-Job</span>


<span class="pl-c"><span class="pl-c">#</span> Math is built in to powershell and has many functions.</span>
<span class="pl-smi">$r</span><span class="pl-k">=</span><span class="pl-c1">2</span>
<span class="pl-smi">$pi</span><span class="pl-k">=</span>[<span class="pl-k">math</span>]::pi
<span class="pl-smi">$r2</span><span class="pl-k">=</span>[<span class="pl-k">math</span>]::pow( <span class="pl-smi">$r</span><span class="pl-k">,</span> <span class="pl-c1">2</span> )
<span class="pl-smi">$area</span> <span class="pl-k">=</span> <span class="pl-smi">$pi</span><span class="pl-k">*</span><span class="pl-smi">$r2</span>
<span class="pl-smi">$area</span>

<span class="pl-c"><span class="pl-c">#</span> To see all possibilities, check the members.</span>
[<span class="pl-k">System.Math</span>] <span class="pl-k">|</span> <span class="pl-c1">Get-Member</span> <span class="pl-k">-</span><span class="pl-k">Static</span> <span class="pl-k">-</span>MemberType All


<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"> This is a silly one:</span>
<span class="pl-c"> You may one day be asked to create a func that could take $start and $end</span>
<span class="pl-c"> and reverse anything in an array within the given range</span>
<span class="pl-c"> based on an arbitrary array without mutating the original array.</span>
<span class="pl-c"> Let's see one way to do that and introduce another data structure.</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>

<span class="pl-smi">$targetArray</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>b<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>c<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>d<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>e<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>f<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>h<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>i<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>j<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>k<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">'</span>m<span class="pl-pds">'</span></span>

<span class="pl-k">function</span> <span class="pl-en">Format-Range</span> (<span class="pl-smi">$start</span><span class="pl-k">,</span> <span class="pl-smi">$end</span><span class="pl-k">,</span> <span class="pl-smi">$array</span>) {
    [<span class="pl-k">System.Collections.ArrayList</span>]<span class="pl-smi">$firstSectionArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()
    [<span class="pl-k">System.Collections.ArrayList</span>]<span class="pl-smi">$secondSectionArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()
    [<span class="pl-k">System.Collections.Stack</span>]<span class="pl-smi">$stack</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()
    <span class="pl-k">for</span> (<span class="pl-smi">$index</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$index</span> <span class="pl-k">-lt</span> <span class="pl-smi">$array<span class="pl-smi">.Count</span></span>; <span class="pl-smi">$index</span><span class="pl-k">++</span>) {
        <span class="pl-k">if</span> (<span class="pl-smi">$index</span> <span class="pl-k">-lt</span> <span class="pl-smi">$start</span>) {
            <span class="pl-smi">$firstSectionArray<span class="pl-smi">.Add</span></span>(<span class="pl-smi">$array</span>[<span class="pl-smi">$index</span>]) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>
        }
        <span class="pl-k">elseif</span> (<span class="pl-smi">$index</span> <span class="pl-k">-ge</span> <span class="pl-smi">$start</span> <span class="pl-k">-and</span> <span class="pl-smi">$index</span> <span class="pl-k">-le</span> <span class="pl-smi">$end</span>) {
            <span class="pl-smi">$stack<span class="pl-smi">.Push</span></span>(<span class="pl-smi">$array</span>[<span class="pl-smi">$index</span>])
        }
        <span class="pl-k">else</span> {
            <span class="pl-smi">$secondSectionArray<span class="pl-smi">.Add</span></span>(<span class="pl-smi">$array</span>[<span class="pl-smi">$index</span>]) <span class="pl-k">&gt;</span> <span class="pl-c1">$null</span>
        }
    }
    <span class="pl-smi">$finalArray</span> <span class="pl-k">=</span> <span class="pl-smi">$firstSectionArray</span> <span class="pl-k">+</span> <span class="pl-smi">$stack<span class="pl-smi">.ToArray</span></span>() <span class="pl-k">+</span> <span class="pl-smi">$secondSectionArray</span>
    <span class="pl-k">return</span> <span class="pl-smi">$finalArray</span>
}

<span class="pl-c1">Format-Range</span> <span class="pl-c1">2</span> <span class="pl-c1">6</span> <span class="pl-smi">$targetArray</span> 
<span class="pl-c"><span class="pl-c">#</span> =&gt; 'a','b','g','f','e','d','c','h','i','j','k','l','m'</span>

<span class="pl-c"><span class="pl-c">#</span> The previous method works, but uses extra memory by allocating new arrays.</span>
<span class="pl-c"><span class="pl-c">#</span> It's also kind of lengthy.</span>
<span class="pl-c"><span class="pl-c">#</span> Let's see how we can do this without allocating a new array.</span>
<span class="pl-c"><span class="pl-c">#</span> This is slightly faster as well.</span>

<span class="pl-k">function</span> <span class="pl-en">Format-Range</span> (<span class="pl-smi">$start</span><span class="pl-k">,</span> <span class="pl-smi">$end</span>) {
  <span class="pl-k">while</span> (<span class="pl-smi">$start</span> <span class="pl-k">-lt</span> <span class="pl-smi">$end</span>)
  {
      <span class="pl-smi">$temp</span> <span class="pl-k">=</span> <span class="pl-smi">$targetArray</span>[<span class="pl-smi">$start</span>]
      <span class="pl-smi">$targetArray</span>[<span class="pl-smi">$start</span>] <span class="pl-k">=</span> <span class="pl-smi">$targetArray</span>[<span class="pl-smi">$end</span>]
      <span class="pl-smi">$targetArray</span>[<span class="pl-smi">$end</span>] <span class="pl-k">=</span> <span class="pl-smi">$temp</span>
      <span class="pl-smi">$start</span><span class="pl-k">++</span>
      <span class="pl-smi">$end</span><span class="pl-k">--</span>
  }
  <span class="pl-k">return</span> <span class="pl-smi">$targetArray</span>
}

<span class="pl-c1">Format-Range</span> <span class="pl-c1">2</span> <span class="pl-c1">6</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 'a','b','g','f','e','d','c','h','i','j','k','l','m'</span></pre></div>
<p>Powershell as a Tool:</p>
<p>Getting Help:</p>
<div class="highlight highlight-source-powershell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> Find commands</span>
<span class="pl-c1">Get-Command</span> about_<span class="pl-k">*</span> <span class="pl-c"><span class="pl-c">#</span> alias: gcm</span>
<span class="pl-c1">Get-Command</span> <span class="pl-k">-</span>Verb Add
<span class="pl-c1">Get-Alias</span> ps
<span class="pl-c1">Get-Alias</span> <span class="pl-k">-</span>Definition <span class="pl-c1">Get-Process</span>

<span class="pl-c1">Get-Help</span> ps <span class="pl-k">|</span> less <span class="pl-c"><span class="pl-c">#</span> alias: help</span>
ps <span class="pl-k">|</span> <span class="pl-c1">Get-Member</span> <span class="pl-c"><span class="pl-c">#</span> alias: gm</span>

<span class="pl-c1">Show-Command</span> <span class="pl-c1">Get-WinEvent</span> <span class="pl-c"><span class="pl-c">#</span> Display GUI to fill in the parameters</span>

<span class="pl-c1">Update-Help</span> <span class="pl-c"><span class="pl-c">#</span> Run as admin</span></pre></div>
<p>If you are uncertain about your environment:</p>
<div class="highlight highlight-source-powershell"><pre class="notranslate"><span class="pl-c1">Get-ExecutionPolicy</span> <span class="pl-k">-</span>List
<span class="pl-c1">Set-ExecutionPolicy</span> AllSigned
<span class="pl-c"><span class="pl-c">#</span> Execution policies include:</span>
<span class="pl-c"><span class="pl-c">#</span> - Restricted: Scripts won't run.</span>
<span class="pl-c"><span class="pl-c">#</span> - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span>
<span class="pl-c"><span class="pl-c">#</span> - AllSigned: Scripts need to be signed by a trusted publisher.</span>
<span class="pl-c"><span class="pl-c">#</span> - Unrestricted: Run all scripts.</span>
help about_Execution_Policies <span class="pl-c"><span class="pl-c">#</span> for more info</span>

<span class="pl-c"><span class="pl-c">#</span> Current PowerShell version:</span>
<span class="pl-c1">$PSVersionTable</span></pre></div>
<div class="highlight highlight-source-powershell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> Calling external commands, executables, </span>
<span class="pl-c"><span class="pl-c">#</span> and functions with the call operator.</span>
<span class="pl-c"><span class="pl-c">#</span> Exe paths with arguments passed or containing spaces can create issues.</span>
C:\Program Files\dotnet\<span class="pl-c1">dotnet.exe</span>
<span class="pl-c"><span class="pl-c">#</span> The term 'C:\Program' is not recognized as a name of a cmdlet,</span>
<span class="pl-c"><span class="pl-c">#</span> function, script file, or executable program.</span>
<span class="pl-c"><span class="pl-c">#</span> Check the spelling of the name, or if a path was included, </span>
<span class="pl-c"><span class="pl-c">#</span> verify that the path is correct and try again</span>

<span class="pl-s"><span class="pl-pds">"</span>C:\Program Files\dotnet\dotnet.exe<span class="pl-pds">"</span></span>
C:\Program Files\dotnet\<span class="pl-c1">dotnet.exe</span>    <span class="pl-c"><span class="pl-c">#</span> returns string rather than execute</span>

<span class="pl-k">&amp;</span><span class="pl-s"><span class="pl-pds">"</span>C:\Program Files\dotnet\dotnet.exe --help<span class="pl-pds">"</span></span>   <span class="pl-c"><span class="pl-c">#</span> fail</span>
<span class="pl-k">&amp;</span><span class="pl-s"><span class="pl-pds">"</span>C:\Program Files\dotnet\dotnet.exe<span class="pl-pds">"</span></span> <span class="pl-k">--</span>help   <span class="pl-c"><span class="pl-c">#</span> success</span>
<span class="pl-c"><span class="pl-c">#</span> Alternatively, you can use dot-sourcing here</span>
.<span class="pl-s"><span class="pl-pds">"</span>C:\Program Files\dotnet\dotnet.exe<span class="pl-pds">"</span></span> <span class="pl-k">--</span>help   <span class="pl-c"><span class="pl-c">#</span> success</span>

<span class="pl-c"><span class="pl-c">#</span> the call operator (&amp;) is similar to Invoke-Expression, </span>
<span class="pl-c"><span class="pl-c">#</span> but IEX runs in current scope.</span>
<span class="pl-c"><span class="pl-c">#</span> One usage of '&amp;' would be to invoke a scriptblock inside of your script.</span>
<span class="pl-c"><span class="pl-c">#</span> Notice the variables are scoped</span>
<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>
<span class="pl-smi">$scriptBlock</span> <span class="pl-k">=</span> { <span class="pl-smi">$i</span><span class="pl-k">=</span><span class="pl-c1">5</span>; <span class="pl-c1">Write-Output</span> <span class="pl-smi">$i</span> }
<span class="pl-k">&amp;</span> <span class="pl-smi">$scriptBlock</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 5</span>
<span class="pl-smi">$i</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 2</span>

<span class="pl-c1">invoke-expression</span> <span class="pl-s"><span class="pl-pds">'</span> $i=5; Write-Output $i <span class="pl-pds">'</span></span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 5</span>
<span class="pl-smi">$i</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 5</span>

<span class="pl-c"><span class="pl-c">#</span> Alternatively, to preserve changes to public variables</span>
<span class="pl-c"><span class="pl-c">#</span> you can use "Dot-Sourcing". This will run in the current scope.</span>
<span class="pl-smi">$x</span><span class="pl-k">=</span><span class="pl-c1">1</span>
<span class="pl-k">&amp;</span>{<span class="pl-smi">$x</span><span class="pl-k">=</span><span class="pl-c1">2</span>};<span class="pl-smi">$x</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 1</span>

.{<span class="pl-smi">$x</span><span class="pl-k">=</span><span class="pl-c1">2</span>};<span class="pl-smi">$x</span> <span class="pl-c"><span class="pl-c">#</span> =&gt; 2</span>


<span class="pl-c"><span class="pl-c">#</span> Remoting into computers is easy.</span>
<span class="pl-c1">Enter-PSSession</span> <span class="pl-k">-</span>ComputerName RemoteComputer

<span class="pl-c"><span class="pl-c">#</span> Once remoted in, you can run commands as if you're local.</span>
RemoteComputer\PS<span class="pl-k">&gt;</span> <span class="pl-c1">Get-Process</span> powershell

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             </span>
<span class="pl-c">-------  ------    -----      -----     ------     --  -- -----------                                             </span>
<span class="pl-c">   1096      44   156324     179068      29.92  11772   1 powershell                                              </span>
<span class="pl-c">    545      25    49512      49852             25348   0 powershell </span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>
RemoteComputer\PS<span class="pl-k">&gt;</span> <span class="pl-c1">Exit-PSSession</span>

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"> Powershell is an incredible tool for Windows management and Automation.</span>
<span class="pl-c"> Let's take the following scenario:</span>
<span class="pl-c"> You have 10 servers.</span>
<span class="pl-c"> You need to check whether a service is running on all of them.</span>
<span class="pl-c"> You can RDP and log in, or PSSession to all of them, but why?</span>
<span class="pl-c"> Check out the following</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span>

<span class="pl-smi">$serverList</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(
    <span class="pl-s"><span class="pl-pds">'</span>server1<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server2<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server3<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server4<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server5<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server6<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server7<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server8<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server9<span class="pl-pds">'</span></span><span class="pl-k">,</span>
    <span class="pl-s"><span class="pl-pds">'</span>server10<span class="pl-pds">'</span></span>
)

[<span class="pl-k">scriptblock</span>]<span class="pl-smi">$script</span> <span class="pl-k">=</span> {
    <span class="pl-c1">Get-Service</span> <span class="pl-k">-</span>DisplayName <span class="pl-s"><span class="pl-pds">'</span>Task Scheduler<span class="pl-pds">'</span></span>
}

<span class="pl-k">foreach</span> (<span class="pl-smi">$server</span> <span class="pl-k">in</span> <span class="pl-smi">$serverList</span>) {
    <span class="pl-smi">$cmdSplat</span> <span class="pl-k">=</span> <span class="pl-k">@</span>{
        <span class="pl-smi">ComputerName</span>  <span class="pl-k">=</span> <span class="pl-smi">$server</span>
        <span class="pl-smi">JobName</span>       <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>checkService<span class="pl-pds">'</span></span>
        <span class="pl-smi">ScriptBlock</span>   <span class="pl-k">=</span> <span class="pl-smi">$script</span>
        <span class="pl-smi">AsJob</span>         <span class="pl-k">=</span> <span class="pl-c1">$true</span>
        <span class="pl-smi">ErrorAction</span>   <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>SilentlyContinue<span class="pl-pds">'</span></span>
    }
    <span class="pl-c1">Invoke-Command</span> <span class="pl-smi">@cmdSplat</span> <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span>
}

<span class="pl-c"><span class="pl-c">&lt;#</span></span>
<span class="pl-c"> Here we've invoked jobs across many servers.</span>
<span class="pl-c"> We can now Receive-Job and see if they're all running.</span>
<span class="pl-c"> Now scale this up 100x as many servers :)</span>
<span class="pl-c"><span class="pl-c">#&gt;</span></span></pre></div>
<p>Interesting Projects</p>
<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en" rel="nofollow">Channel9</a> PowerShell tutorials</li>
<li><a href="https://powershellexplained.com/" rel="nofollow">KevinMarquette's Powershell Blog</a> Excellent blog that goes into great detail on Powershell</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet for PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> A bash inspired readline implementation for PowerShell (So good that it now ships with Windows10 by default!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Fancy Git Prompt (Recommended!)</li>
<li><a href="https://github.com/JanDeDobbeleer/oh-my-posh">Oh-My-Posh</a> Shell customization similar to the popular Oh-My-Zsh on Mac</li>
<li><a href="https://github.com/psake/psake">PSake</a> Build automation tool</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD Testing Framework</li>
<li><a href="https://github.com/vors/ZLocation">ZLocation</a> Powershell <code class="notranslate">cd</code> that reads your mind</li>
<li><a href="https://github.com/Pscx/Pscx">PowerShell Community Extensions</a></li>
<li><a href="https://github.com/PowerShell/PowerShell/issues/1908" data-hovercard-type="issue" data-hovercard-url="/PowerShell/PowerShell/issues/1908/hovercard">More on the Powershell Pipeline Issue</a></li>
</ul>
<hr>
<h2>Contributors</h2>
<pre class="notranslate"><code class="notranslate">- ["Wouter Van Schandevijl", "https://github.com/laoujin"]
- ["Andrew Ryan Davis", "https://github.com/AndrewDavis1191"]
</code></pre>